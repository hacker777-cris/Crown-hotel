<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The Crown Hotel</title>
  <!-- Meta tags for responsiveness -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Include Slick's CSS -->
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
<!-- Example of including flatpickr from CDN -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>




  <!-- Tailwind CSS CDN -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="font-sans bg-gradient-to-r from-purple-500 to-indigo-500"> <!-- Adjust the gradient color -->
  <!-- Navigation Bar -->
  <nav class="bg-gray-900 text-white p-4 sticky top-0 z-50"> <!-- z-50 for higher stacking -->
    <div class="container mx-auto flex justify-between items-center">
      <a href="#" class="text-xl font-bold">The Crown Hotel</a>
      <ul class="flex space-x-4">
        <li><a href="#" class="hover:underline">Home</a></li>
        <li><a href="#bookings" class="hover:underline">Bookings</a></li>
        <li><a href="#contact" class="hover:underline">Contact Us</a></li>
      </ul>
    </div>
  </nav>
<!-- Home Section -->
<section class="py-20 relative" style="background-image: url('img/hero-bg.jpg');">
  <div class="absolute inset-0 bg-black opacity-50"></div>
  <div class="container mx-auto text-white relative z-10 flex flex-col lg:flex-row items-center">
    <div class="w-full lg:w-1/2 text-center lg:text-left px-6 lg:px-0">
      <h1 class="text-5xl lg:text-6xl font-bold mb-6 leading-tight">Welcome to The Crown Hotel</h1>
      <p class="text-lg lg:text-xl mb-8 leading-relaxed">Discover The Crown Hotel: Norwich's newest gem on the city's western edge. Unwind in style with our gym, bar, and restaurant. Host seamless meetings in our three versatile function rooms. Experience modern luxury against Norwich's charming backdrop. Welcome to a stay where every detail exceeds expectations.</p>
      <a href="#bookings" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-8 rounded-full inline-block">Book Now</a>
    </div>
    <div class="hidden lg:block lg:w-1/2 relative">
      <div class="slick-carousel">
        <div><img src="img/hotel 1.jpg" alt="Hotel Image 1" class="rounded-lg shadow-md"></div>
        <div><img src="img/hotel 2.jpg" alt="Hotel Image 2" class="rounded-lg shadow-md"></div>
        <div><img src="img/hotel 3.jpg" alt="Hotel Image 3" class="rounded-lg shadow-md"></div>
        <div><img src="img/hotel 4.jpg" alt="Hotel Image 4" class="rounded-lg shadow-md"></div>
        
        <!-- Add more slides as needed -->
      </div>
      <button class="absolute top-1/2 -translate-y-1/2 left-0 bg-gray-500 text-white font-bold py-3 px-4 rounded-full" onclick="$('.slick-carousel').slick('slickPrev')"><</button>
      <button class="absolute top-1/2 -translate-y-1/2 right-0 bg-gray-500 text-white font-bold py-3 px-4 rounded-full" onclick="$('.slick-carousel').slick('slickNext')">></button>
    </div>
  </div>
</section>





<!-- Bookings Section -->
<section id="bookings" class="py-10 bg-gray-100" >
  <div class="container mx-auto">
    <h2 class="text-3xl font-bold mb-8 text-center">Available Rooms</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
      <!-- Standard Rooms -->
<div class="bg-white rounded-lg overflow-hidden shadow-lg flex flex-col justify-between">
  <div class="p-6">
    <h3 class="text-2xl lg:text-3xl font-bold mb-4 text-gray-800">Standard Rooms</h3>
    <p class="text-lg lg:text-xl text-gray-600">Facilities: Standard</p>
    <p id="std_tPrice" class="mt-4 text-gray-600">Price: </p>
    <p id="standardSingleAvailable" class="mt-4 text-gray-600">Standard Single Rooms: 0 rooms</p>
    <p id="standardDoubleAvailable" class="mt-2 text-gray-600">Standard Double Rooms: 0 rooms</p>
  </div>
  <button id="showFormStandard" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 rounded-b-lg w-full">Book Now</button>
</div>

<!-- Superior Rooms -->
<div class="bg-white rounded-lg overflow-hidden shadow-lg flex flex-col justify-between mt-8 lg:mt-0">
  <div class="p-6">
    <h3 class="text-2xl lg:text-3xl font-bold mb-4 text-gray-800">Superior Rooms</h3>
    <p class="text-lg lg:text-xl text-gray-600">Facilities: Superior</p>
    <p id="sup_tPrice" class="mt-4 text-gray-600">Price: </p>
    <p id="superiorSingleAvailable" class="mt-4 text-gray-600">Superior Single Rooms: 0 rooms</p>
    <p id="superiorDoubleAvailable" class="mt-2 text-gray-600">Superior Double Rooms: 0 rooms</p>
  </div>
  <button id="showFormSuperior" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 rounded-b-lg w-full">Book Now</button>
</div>
</section>

<!--Booking form-->
<section id="bookingFormSection" class="py-10 bg-gray-100 hidden bg-cover bg-center" style="background-image: url('img/bookings-bg.jpg')">
  <div class="container mx-auto">
    <div id="bookingForm" class="bg-white shadow-md rounded-lg px-8 py-6 mb-8">
    <div class="mb-4">
      <label class="block text-gray-700 text-sm font-bold mb-2" for="name">
        Name
      </label>
      <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="name" type="text" placeholder="Enter your name">
    </div>
    <div class="mb-4">
      <label class="block text-gray-700 text-sm font-bold mb-2" for="email">
        Email
      </label>
      <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="email" type="email" placeholder="Enter your email">
    </div>
    <!-- Add fields for customer's address, card type, card expiration, and card number -->
    <div class="mb-4">
      <label class="block text-gray-700 text-sm font-bold mb-2" for="address">
        Address
      </label>
      <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="address" type="text" placeholder="Enter your address">
    </div>
    <div class="mb-6">
      <label class="block text-gray-700 text-sm font-bold mb-2" for="cardNo">
        Card Number
      </label>
      <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="cardNo" type="text" placeholder="Enter card number">
    </div>
    <div class="mb-4">
      <label class="block text-gray-700 text-sm font-bold mb-2" for="cardType">
        Card Type (V/MC/A)
      </label>
      <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="cardType" type="text" placeholder="Enter card type (V/MC/A)">
    </div>
    <div class="mb-4">
      <label class="block text-gray-700 text-sm font-bold mb-2" for="cardExp">
        Card Expiration (MM/YY)
      </label>
      <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="cardExp" type="text" placeholder="Enter card expiration (MM/YY)">
    </div>
    
     <!-- Room Type Dropdown -->
     <div class="mb-4">
      <label class="block text-gray-700 text-sm font-bold mb-2" for="roomType">
        Room Type
      </label>
      <select class="block appearance-none w-full border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="roomType">
        <option value="standard">Standard</option>
        <option value="superior">Superior</option>
      </select>
    </div>
  <!-- Available Rooms Dropdown -->
  <div class="mb-4" id="availableRooms" style="display: none;">
    <label class="block text-gray-700 text-sm font-bold mb-2" for="availableRoomsDropdown">
      Available Rooms
    </label>
    <select class="block appearance-none w-full border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline max-h-40 overflow-y-auto text-sm" id="availableRoomsDropdown"></select>
  </div>
  <!-- Check-In and Check-Out Dates -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <div class="mb-4">
      <label class="block text-gray-700 text-sm font-bold mb-2" for="checkin">
        Check-In
      </label>
      <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="checkin" type="text" placeholder="Select check-in date">
    </div>
    <div class="mb-4">
      <label class="block text-gray-700 text-sm font-bold mb-2" for="checkout">
        Check-Out
      </label>
      <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="checkout" type="text" placeholder="Select check-out date">
    </div>
  </div>  
    <!-- Phone Number -->
    <div class="mb-6">
      <label class="block text-gray-700 text-sm font-bold mb-2" for="phone">
        Phone Number
      </label>
      <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="phone" type="text" placeholder="Enter your phone number">
    </div>

    <!-- Buttons -->
    <div class="flex items-center justify-between">
      <button class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="button" id="submitBooking">
        Submit
      </button>
      <button class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="button" id="cancelBooking">
        Cancel
      </button>
    </div>
  </div>
</div>
</section>


<!-- Success Message Section -->
<section id="successMessage" class="py-10 bg-green-200 hidden">
  <div class="container mx-auto">
    <div class="bg-green-500 text-white font-bold rounded-lg shadow-lg p-8">
      <p class="text-center text-xl">Booking created successfully!</p>
    </div>
  </div>
</section>

<!-- Printable Booking Details Section -->
<section id="printableBookingDetails" class="hidden">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8">
    <div id="bookingDetails" class="bg-white shadow-md rounded-lg p-6 mb-4">
      <!-- Booking details will be dynamically added here -->
    </div>
    <button id="printButton" class="block w-full sm:w-auto bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">Print</button>
  </div>
</section>




<!-- Contact Us Section -->
<section id="contact" class="relative py-20" style="background-image: url('img/bookings-bg.jpg');">
  <div class="absolute inset-0 bg-black opacity-75"></div>
  <div class="container mx-auto text-white relative z-10">
    <h2 class="text-4xl lg:text-5xl font-bold mb-8 text-center">Contact Us</h2>
    <div class="flex justify-center items-center space-x-4">
      <div class="w-full lg:w-1/2">
        <div class="bg-gray-200 bg-opacity-90 rounded-lg shadow-md p-6">
          <h3 class="text-2xl lg:text-3xl font-bold mb-4">Get In Touch</h3>
          <ul class="list-disc ml-6 text-lg lg:text-xl text-gray-800">
            <li><span class="font-bold">Phone:</span> <a href="tel:123-456-7890" class="text-blue-600">123-456-7890</a></li>
            <li><span class="font-bold">Email:</span> <a href="mailto:info@thecrownhotel.com" class="text-blue-600">info@thecrownhotel.com</a></li>
            <li><span class="font-bold">Address:</span> 123 Hotel Street, City, Country</li>
          </ul>
          <div class="flex justify-center mt-8">
            <!-- Add social media icons/links here if available -->
          </div>
        </div>
      </div>
      <div class="hidden lg:block lg:w-1/2">
        <!-- Consider adding an image or illustration here -->
      </div>
    </div>
  </div>
</section>




  <!-- Footer -->
  <footer class="bg-gray-800 text-white py-4">
    <div class="container mx-auto text-center">
      &copy; 2023 The Crown Hotel. All rights reserved.
    </div>
  </footer>

<!-- Swiper JS -->
<script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> <!-- Include jQuery -->


<!-- Include Slick's JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

<!-- Initialize Slick -->
<!-- Initialize Slick -->
<script>
  $(document).ready(function(){
    $('.slick-carousel').slick({
      autoplay: true,
      autoplaySpeed: 5000, // Adjust the slide duration
      // Add other settings as needed
    });
  });
</script>

<!-- get rooms -->
<script>
$(document).ready(function() {
  // Make an AJAX GET request to fetch available room data from your server
  $.ajax({
    url: 'http://localhost:3000/api/rooms', // Endpoint for available rooms
    method: 'GET',
    success: function(data) {
      // Handle the retrieved room data here
      console.log('Available Rooms:', data);

      // Calculate total available rooms for standard and superior classes (single and double)
      const standardSingleRooms = data.filter(room => room.r_class === 'std_t' && room.r_status === 'A').length;
      const standardDoubleRooms = data.filter(room => room.r_class === 'std_d' && room.r_status === 'A').length;
      const superiorSingleRooms = data.filter(room => room.r_class === 'sup_t' && room.r_status === 'A').length;
      const superiorDoubleRooms = data.filter(room => room.r_class === 'sup_d' && room.r_status === 'A').length;

      // Update the total available rooms for each type in the HTML
      $('#standardSingleAvailable').text('Standard Single Rooms: ' + standardSingleRooms);
      $('#standardDoubleAvailable').text('Standard Double Rooms: ' + standardDoubleRooms);
      $('#superiorSingleAvailable').text('Superior Single Rooms: ' + superiorSingleRooms);
      $('#superiorDoubleAvailable').text('Superior Double Rooms: ' + superiorDoubleRooms);
    },
    error: function(err) {
      console.error('Error fetching data:', err);
    }
  });
});

</script>

<!-- fetch available rooms for dropdown based on room type -->
<script>
  // fetch available rooms for dropdown based on room type
const roomTypeDropdown = document.getElementById('roomType');
const availableRoomsDiv = document.getElementById('availableRooms');
const availableRoomsDropdown = document.getElementById('availableRoomsDropdown');

roomTypeDropdown.addEventListener('change', () => {
  const selectedRoomType = roomTypeDropdown.value;

  fetch(`http://localhost:3000/api/rooms`)
    .then(response => response.json())
    .then(data => {
      const filteredRooms = data.filter(room => {
        if (selectedRoomType === 'standard') {
          return room.r_class.includes('std');
        } else if (selectedRoomType === 'superior') {
          return room.r_class.includes('sup');
        }
        return false;
      });

      availableRoomsDropdown.innerHTML = ''; // Clear previous options

      if (filteredRooms.length > 0) {
        filteredRooms.forEach(room => {
          const option = document.createElement('option');
          option.value = room.r_no;
          const roomType = room.r_class.includes('_t') ? 'Single' : 'Double';
          option.text = `Room ${room.r_no} (${roomType})`; // Display whether it's Single or Double
          availableRoomsDropdown.appendChild(option);
        });

        availableRoomsDiv.style.display = 'block'; // Show the available rooms dropdown
      } else {
        availableRoomsDiv.style.display = 'none'; // Hide if no available rooms
      }
    })
    .catch(error => console.error('Error fetching available rooms:', error));
});
</script>


<!--book room-->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const submitBtn = document.getElementById('submitBooking');

    submitBtn.addEventListener('click', function () {
      const selectedRoomNo = document.getElementById('availableRoomsDropdown').value;

      fetch(`http://localhost:3000/api/roomDetails?r_no=${selectedRoomNo}`)
        .then((response) => {
          if (!response.ok) {
            throw new Error('Failed to fetch room details');
          }
          return response.json();
        })
        .then((roomDetails) => {
          const roomClass = roomDetails.roomClass
          const classMappings = {
            'superior double': 'sup_d',
            'superior single': 'sup_t',
            'standard double': 'std_d',
            'standard single': 'std_t',
            // Add mappings for other room types and classes as needed
          };

          const roomRatesEndpoint = `http://localhost:3000/api/rates/${roomClass}`;

          fetch(roomRatesEndpoint)
            .then((response) => {
              if (!response.ok) {
                throw new Error('Network response was not ok');
              }
              return response.json();
            })
            .then((roomCostData) => {
              const nameInput = document.getElementById('name');
              const emailInput = document.getElementById('email');
              const addressInput = document.getElementById('address');
              const cardType = document.getElementById('cardType').value;
              const cardExp = document.getElementById('cardExp').value;
              const cardNo = document.getElementById('cardNo').value;
              const checkin = document.getElementById('checkin').value;
              const checkout = document.getElementById('checkout').value;
              const phone = document.getElementById('phone').value;

              const name = nameInput.value;
              const email = emailInput.value;
              const address = addressInput.value;

              const roomCost = roomCostData.price; // Assuming the response has a 'price' field

              // Prepare the data to send to the server with the retrieved room cost
              const bookingData = {
                email: email,
                r_no: selectedRoomNo,
                checkIn: checkin,
                checkOut: checkout,
                cost: roomCost, // Use the retrieved room cost
                outstanding: 0,
                notes: `Phone: ${phone}`,
                customerData: {
                  name: name,
                  address: address,
                  cardType: cardType,
                  cardExp: cardExp,
                  cardNo: cardNo,
                },
              };

              fetch('http://localhost:3000/api/bookRoom', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                },
                body: JSON.stringify(bookingData),
              })
                .then((response) => {
                  if (!response.ok) {
                    throw new Error('Network response was not ok');
                  }
                  return response.json();
                })
                .then((data) => {
                  const successMessageSection = document.getElementById('successMessage');
                  successMessageSection.classList.remove('hidden');

                  // Retrieve booking details after successful booking creation
                  fetchBookingDetails(selectedRoomNo, name, email, address);
                })
                .catch((error) => {
                  console.error('There was a problem with the booking:', error);
                  // Optionally, show an error message to the user
                });
            })
            .catch((error) => {
              console.error('Error fetching room cost:', error);
              // Optionally, handle error scenario or show an error message
            });
        })
        .catch((error) => {
          console.error('Error fetching room details:', error);
          // Optionally, handle error scenario or show an error message
        });
    });

    function fetchBookingDetails(roomNumber) {
      const bookingRequestData = { r_no: roomNumber };
      const name = document.getElementById('name');
      const email = document.getElementById('email');
      const address = document.getElementById('address');

      fetch('http://localhost:3000/api/bookingDetails', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(bookingRequestData),
      })
        .then((response) => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.json();
        })
        .then((bookingDetails) => {
          const bookingDetailsSection = document.getElementById('bookingDetails');
          const printableBookingDetails = document.getElementById('printableBookingDetails');

          bookingDetailsSection.innerHTML = `
          <h2 class="text-2xl font-bold mb-4">Booking Details for Room ${roomNumber}</h2>
          <p><strong>Name:</strong> ${name.value}</p>
          <p><strong>Email:</strong> ${email.value}</p>
          <p><strong>Address:</strong> ${address.value}</p>
          <p><strong>Check-In:</strong> ${bookingDetails[0]?.checkin}</p>
          <p><strong>Check-Out:</strong> ${bookingDetails[0]?.checkout}</p>
          <!-- Include other relevant booking details -->
        `;

        printableBookingDetails.classList.remove('hidden');

const printButton = document.getElementById('printButton');
printButton.addEventListener('click', function () {
  const printableArea = document.getElementById('printableBookingDetails').innerHTML;
  const printWindow = window.open('', '_blank');
  printWindow.document.open();
  printWindow.document.write(`
    <html>
      <head>
        <title>Printable Booking Details</title>
        <style>
          /* Include any necessary styles for printing */
          /* For example, hide the print button in the printout */
          #printButton {
            display: none;
          }
        </style>
      </head>
      <body>${printableArea}</body>
    </html>
  `);
  printWindow.document.close();
  printWindow.print();
});
})
.catch((error) => {
console.error('Error fetching booking details:', error);
// Handle error scenario or show an error message
});
}
});
</script>

<script>
  // JavaScript to fetch rates and update room cards
  $(document).ready(function() {
    // Make an AJAX GET request to fetch rates data from the server
    $.ajax({
      url: 'http://localhost:3000/api/rates', // Endpoint for rates
      method: 'GET',
      success: function(data) {
        // Filter out duplicate entries
        const uniqueRates = [];
        const uniqueClassNames = [];
        data.forEach(rate => {
          if (!uniqueClassNames.includes(rate.r_class)) {
            uniqueClassNames.push(rate.r_class);
            uniqueRates.push(rate);
          }
        });

        console.log('Unique Rates:', uniqueRates);

        uniqueRates.forEach(rate => {
          const { r_class, price } = rate;
          const elementId = `${r_class}Price`;
          const element = document.getElementById(elementId);
          if (element) {
            element.textContent = `Price: $${price}`;
          } else {
            console.error(`Element with ID ${elementId} not found.`);
          }
        });
      },
      error: function(err) {
        console.error('Error fetching rates:', err);
      }
    });
  });
</script>


<!-- show bookings form -->
<script>
// JavaScript for showing the booking form
document.addEventListener("DOMContentLoaded", function() {
  const showFormStandard = document.getElementById('showFormStandard');
  const showFormSuperior = document.getElementById('showFormSuperior');
  const bookingFormSection = document.getElementById('bookingFormSection');
  const cancelBooking = document.getElementById('cancelBooking');

  function showBookingForm() {
    bookingFormSection.classList.remove('hidden');
  }

  function hideBookingForm() {
    bookingFormSection.classList.add('hidden');
  }

  showFormStandard.addEventListener('click', showBookingForm);
  showFormSuperior.addEventListener('click', showBookingForm);
  cancelBooking.addEventListener('click', hideBookingForm);
});

</script>

<script>
  // Initialize date pickers for check-in and check-out
flatpickr("#checkin", {
  dateFormat: "Y-m-d",
  minDate: "today",
  onChange: function(selectedDates, dateStr) {
    // Set the minimum date for check-out as the selected check-in date
    flatpickr("#checkout", {
      dateFormat: "Y-m-d",
      minDate: dateStr,
    });
  }
});

</script>



<script>
  document.getElementById('cardNo').addEventListener('input', function() {
    const cardNumber = this.value.trim().replace(/\s/g, ''); // Remove spaces from input

    let cardType = '';

    if (/^4\d{15}$/.test(cardNumber)) {
      cardType = 'V';
    } else if (/^5[1-5]\d{14}$/.test(cardNumber)) {
      cardType = 'Mc';
    } else if (/^3[47]\d{13}$/.test(cardNumber)) {
      cardType = 'A';
    } else {
      cardType = 'Unknown';
    }

    document.getElementById('cardType').value = cardType; // Set the card type input value
  });
</script>

</body>
</html>
